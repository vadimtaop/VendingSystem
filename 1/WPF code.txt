using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VendingSystemWPF.ADO
{
    public static class AppData
    {
        public static VendingSystemDBEntities db = new VendingSystemDBEntities();
    }
}
<Page x:Class="VendingSystemWPF.Pages.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:VendingSystemWPF.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="700"
      d:DesignWidth="700"
      Title="ООО Торговые Автоматы">
    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid Background="LightBlue" Grid.Row="0">
            <TextBlock Text="ООО Торговые Автоматы"
                       Foreground="White"
                       FontSize="18"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Margin="10 0 0 0"/>
            <TextBlock Text="Главная"
                       Foreground="Gray"
                       FontSize="18"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Center"
                       Margin="0 0 10 0"/>
        </Grid>
    </Grid>
</Page>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using VendingSystemWPF.ADO;

namespace VendingSystemWPF.Pages
{
    /// <summary>
    /// Логика взаимодействия для MainPage.xaml
    /// </summary>
    public partial class MainPage : Page
    {
        public MainPage()
        {
            InitializeComponent();
        }
    }
}
<Page x:Class="VendingSystemWPF.Pages.VendingMachinesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:VendingSystemWPF.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="700"
      d:DesignWidth="700"
      Title="ООО Торговые Автоматы">
    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Background="LightBlue" Grid.Row="0">
            <TextBlock Text="ООО Торговые Автоматы"
                       Foreground="White"
                       FontSize="18"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Margin="10 0 0 0"/>
            <TextBlock Text="Администрирование / Торговые автоматы"
                       Foreground="Gray"
                       FontSize="18"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Center"
                       Margin="0 0 10 0"/>
        </Grid>

        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="100"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel HorizontalAlignment="Left"
                            VerticalAlignment="Top"
                            Orientation="Vertical"
                            Margin="5">
                    <TextBlock Text="Торговые автоматы"
                               Foreground="Blue"
                               FontSize="18"/>
                    <TextBlock Text="Найдено всего 0 шт."
                               FontSize="14"
                               Name="CountTextBlock"/>
                </StackPanel>

                <Grid Grid.Row="1"
                      Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="220"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="220"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <TextBlock Text="Показать"
                               FontSize="14"/>
                        <TextBox Height="30"
                                 Width="40"
                                 Margin="5 0 5 0"
                                 MaxLength="3"
                                 Name="LimitTextBox"
                                 TextChanged="LimitTextChanged"/>
                        <TextBlock Text="записей"
                               FontSize="14"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <TextBox Height="30"
                                 Width="200"
                                 MaxLength="255"
                                 Name="FilterTextBox"
                                 TextChanged="FilterTextChanged"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <Button Content="Добавить"
                                Height="30"
                                Width="100"
                                Background="White"
                                Click="AddButtonClick"/>
                        <Button Content="Экспорт"
                                Height="30"
                                Width="100"
                                Background="White"
                                Margin="10 0 0 0"/>
                    </StackPanel>

                </Grid>

            </Grid>

            <DataGrid Name="VendingMachinesDataGrid"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      RowBackground="White"
                      AlternatingRowBackground="LightGray"
                      Grid.Row="1">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" MinWidth="50" Binding="{Binding Id}"/>
                    <DataGridTextColumn Header="Название" MinWidth="100" Binding="{Binding Name}" Foreground="Blue"/>
                    <DataGridTextColumn Header="Модель" MinWidth="100" Binding="{Binding Model}"/>
                    <DataGridTextColumn Header="Компания" MinWidth="100" Binding="{Binding Companies.Title}" Foreground="Blue"/>
                    <DataGridTextColumn Header="Адрес" MinWidth="120" Width="*" Binding="{Binding Address}"/>
                    <DataGridTextColumn Header="В работе с" MinWidth="100" Binding="{Binding StartDate, StringFormat='dd.MM.yyyy'}"/>
                    <DataGridTemplateColumn Header="Действия" MinWidth="150">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center">
                                    <Button Content="1"
                                            Height="20"
                                            Width="20"
                                            Background="Transparent"
                                            Foreground="AliceBlue"
                                            BorderThickness="0"/>
                                    <Button Content="2"
                                            Height="20"
                                            Width="20"
                                            Margin="10 0 0 0"
                                            Background="Transparent"
                                            Foreground="AliceBlue"
                                            BorderThickness="0"/>
                                    <Button Content="У"
                                            Height="20"
                                            Width="20"
                                            Margin="10 0 0 0"
                                            Background="Red"
                                            BorderThickness="0"
                                            Click="DeleteButtonClick"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

    </Grid>
</Page>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using VendingSystemWPF.ADO;
using VendingSystemWPF.Windows;

namespace VendingSystemWPF.Pages
{
    /// <summary>
    /// Логика взаимодействия для VendingMachinesPage.xaml
    /// </summary>
    public partial class VendingMachinesPage : Page
    {
        public VendingMachinesPage()
        {
            InitializeComponent();

            LoadData();
        }
        
        private void LoadData()
        {
            var data = AppData.db.VendingMachines.ToList();

            VendingMachinesDataGrid.ItemsSource = data;

            CountTextBlock.Text = $"Всего найдено {data.Count()} шт.";
        }

        private void FilterTextChanged(object sender, TextChangedEventArgs e)
        {
            FilterAndLimit();
        }

        private void LimitTextChanged(object sender, TextChangedEventArgs e)
        {
            FilterAndLimit();
        }

        private void FilterAndLimit()
        {
            try
            {
                var data = AppData.db.VendingMachines.ToList();

                string textFilter = FilterTextBox.Text.ToLower();

                if (!string.IsNullOrEmpty(textFilter))
                {
                    data = data.Where(p => p.Name.ToLower().Contains(textFilter)).ToList();
                }

                if (int.TryParse(LimitTextBox.Text, out int limit) && limit > 0)
                {
                    data = data.Take(limit).ToList();
                }

                int countData = data.Count;

                VendingMachinesDataGrid.ItemsSource = data;
                CountTextBlock.Text = $"Всего найдено {countData} шт.";
            }
            catch (Exception ex)
            {
                MessageBox.Show($"{ex.Message}");
            }
        }

        private void AddButtonClick(object sender, RoutedEventArgs e)
        {
            AddVendingMachineWindow addVendingMachineWindow = new AddVendingMachineWindow();
            addVendingMachineWindow.ShowDialog();

            LoadData();
        }

        private void DeleteButtonClick(object sender, RoutedEventArgs e)
        {
            try
            {
                if (MessageBox.Show("Вы уверены, что хотите удалить данные?",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.YesNo,
                    MessageBoxImage.Information) == MessageBoxResult.Yes)
                {
                    if (VendingMachinesDataGrid.SelectedItem is VendingMachines vendingMachines)
                    {
                        AppData.db.VendingMachines.Remove(vendingMachines);
                        AppData.db.SaveChanges();

                        LoadData();

                        MessageBox.Show("Данные успешно удалены!",
                            "ООО Торговые Автоматы",
                            MessageBoxButton.OK,
                            MessageBoxImage.Information);
                    }
                    else
                    {
                        MessageBox.Show("Данные не выбраны!",
                            "ООО Торговые Автоматы",
                            MessageBoxButton.OK,
                            MessageBoxImage.Error);
                    }
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Произошла ошибка: {ex.Message}",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.OK,
                    MessageBoxImage.Error);
            }
        }
    }
}
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;

namespace VendingSystemWPF.Services
{
    public class ApiService // internal поменять на public
    {
        private HttpClient http = new HttpClient();

        public async Task<dynamic> GetMachines()
        {
            var resp = await http.GetAsync("https://localhost:7077/api/vendingmachines");
            var json = await resp.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(json);
        }

        public async Task<dynamic> Login(string login, string password)
        {
            var body = JsonConvert.SerializeObject(new { Login = login, Password = password });

            var content = new StringContent(body, Encoding.UTF8, "application/json");

            var resp = await http.PostAsync("https://localhost:7077/api/auth/login", content);

            var json = await resp.Content.ReadAsStringAsync();

            if (!resp.IsSuccessStatusCode)
            {
                return null;
            }

            return JsonConvert.DeserializeObject(json);
        }
    }
}
<Window x:Class="VendingSystemWPF.Windows.AddVendingMachineWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VendingSystemWPF.Windows"
        mc:Ignorable="d"
        Title="ООО Торговые Автоматы"
        Height="700"
        Width="700"
        MinHeight="700"
        MinWidth="700"
        WindowStartupLocation="CenterScreen"
        Icon="/Images/icon.png">
    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>
        <Grid Background="LightBlue" Grid.Row="0">
            <TextBlock Text="Создание торгового автомата"
                       Foreground="White"
                       FontSize="18"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Margin="10 0 0 0"/>
        </Grid>

        <UniformGrid Grid.Row="1"
                     Margin="10"
                     Columns="3"
                     Height="500">
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Название"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="NameTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Адрес"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="AddressTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Модель"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="ModelTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Тип"
                           Style="{StaticResource AddTextBlock}"/>
                <ComboBox Style="{StaticResource AddComboBox}"
                         Name="TypeComboBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Серийный номер"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="SerialNumberTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Инвентарный номер"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="InventoryNumberTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Производитель"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="ManufacturerTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Дата изготовления"
                           Style="{StaticResource AddTextBlock}"/>
                <DatePicker Style="{StaticResource AddDatePicker}"
                         Name="ManufactureDatePicker"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Дата начала эксплуатации"
                           Style="{StaticResource AddTextBlock}"/>
                <DatePicker Style="{StaticResource AddDatePicker}"
                         Name="StartDatePicker"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Ресурс в часах"
                           Style="{StaticResource AddTextBlock}"/>
                <TextBox Style="{StaticResource AddTextBox}"
                         Name="ResourceHourTextBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Статус"
                           Style="{StaticResource AddTextBlock}"/>
                <ComboBox Style="{StaticResource AddComboBox}"
                         Name="StatusComboBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Страна производства"
                           Style="{StaticResource AddTextBlock}"/>
                <ComboBox Style="{StaticResource AddComboBox}"
                         Name="CountryComboBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Компания"
                           Style="{StaticResource AddTextBlock}"/>
                <ComboBox Style="{StaticResource AddComboBox}"
                         Name="CompanyComboBox"/>
            </Grid>
            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                <TextBlock Text="Модем"
                           Style="{StaticResource AddTextBlock}"/>
                <ComboBox Style="{StaticResource AddComboBox}"
                         Name="ModemComboBox"/>
            </Grid>
        </UniformGrid>

        <StackPanel VerticalAlignment="Center"
                    HorizontalAlignment="Left"
                    Grid.Row="2"
                    Orientation="Horizontal">
            <Button Content="Добавить"
                    Height="30"
                    Width="150"
                    FontSize="14"
                    Click="AddButtonClick"
                    Background="LightBlue"
                    BorderThickness="0"
                    Margin="50 0 0 0"/>
            <Button Content="Отменить"
                    Height="30"
                    Width="150"
                    FontSize="14"
                    Click="CancelButtonClick"
                    Background="LightGray"
                    BorderThickness="0"
                    Margin="20 0 0 0"/>
        </StackPanel>

    </Grid>
</Window>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using VendingSystemWPF.ADO;
using static System.Net.Mime.MediaTypeNames;

namespace VendingSystemWPF.Windows
{
    /// <summary>
    /// Логика взаимодействия для AddVendingMachineWindow.xaml
    /// </summary>
    public partial class AddVendingMachineWindow : Window
    {
        public AddVendingMachineWindow()
        {
            InitializeComponent();

            LoadData();
        }

        private void LoadData()
        {
            try
            {
                TypeComboBox.ItemsSource = AppData.db.MachineTypes.ToList();
                TypeComboBox.DisplayMemberPath = "Title";
                TypeComboBox.SelectedValuePath = "Id";

                StatusComboBox.ItemsSource = AppData.db.MachineStatuses.ToList();
                StatusComboBox.DisplayMemberPath = "Title";
                StatusComboBox.SelectedValuePath = "Id";

                CountryComboBox.ItemsSource = AppData.db.Countries.ToList();
                CountryComboBox.DisplayMemberPath = "Title";
                CountryComboBox.SelectedValuePath = "Id";

                CompanyComboBox.ItemsSource = AppData.db.Companies.ToList();
                CompanyComboBox.DisplayMemberPath = "Title";
                CompanyComboBox.SelectedValuePath = "Id";

                ModemComboBox.ItemsSource = AppData.db.Modems.ToList();
                ModemComboBox.DisplayMemberPath = "Title";
                ModemComboBox.SelectedValuePath = "Id";
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Произошла ошибка: {ex.Message}",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.OK,
                    MessageBoxImage.Error);
            }
        }

        private void AddButtonClick(object sender, RoutedEventArgs e)
        {
            try
            {
                VendingMachines vendingMachines = new VendingMachines();

                vendingMachines.Name = NameTextBox.Text;
                vendingMachines.Address = AddressTextBox.Text;
                vendingMachines.Model = ModelTextBox.Text;

                vendingMachines.MachineTypeId = (int)TypeComboBox.SelectedValue;

                vendingMachines.SerialNumber = SerialNumberTextBox.Text;
                vendingMachines.InventoryNumber = InventoryNumberTextBox.Text;
                vendingMachines.Manufacturer = ManufacturerTextBox.Text;

                vendingMachines.ManufactureDate = ManufactureDatePicker.SelectedDate.Value;
                vendingMachines.StartDate = StartDatePicker.SelectedDate.Value;

                vendingMachines.ResourceHour = int.Parse(ResourceHourTextBox.Text);

                vendingMachines.StatusId = (int)StatusComboBox.SelectedValue;
                vendingMachines.CountryId = (int)CountryComboBox.SelectedValue;
                vendingMachines.CompanyId = (int)CompanyComboBox.SelectedValue;
                vendingMachines.ModemId = (int)ModemComboBox.SelectedValue;

                vendingMachines.TotalProfit = 1;
                vendingMachines.LastCheckDate = DateTime.Now;
                vendingMachines.InterCheckMonth =1;
                vendingMachines.NextCheckDate = DateTime.Now;
                vendingMachines.ServiceTime = 1;
                vendingMachines.InventoryDate = DateTime.Now;
                vendingMachines.CreateDate = DateTime.Now;

                AppData.db.VendingMachines.Add(vendingMachines);
                AppData.db.SaveChanges();

                MessageBox.Show("Данные успешно добавлены!",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.OK,
                    MessageBoxImage.Information);

                this.Close();
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Произошла ошибка: {ex.Message}",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.OK,
                    MessageBoxImage.Error);
            }
        }

        private void CancelButtonClick(object sender, RoutedEventArgs e)
        {
            this.Close();
        }
    }
}
<Window x:Class="VendingSystemWPF.Windows.AuthWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VendingSystemWPF.Windows"
        mc:Ignorable="d"
        Title="ООО Торговые Автоматы"
        Height="500"
        Width="800"
        MinHeight="500"
        MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Icon="/Images/icon.png">
    <Grid Background="AliceBlue">
        <StackPanel Orientation="Vertical"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
            <TextBlock Text="Авторизация"
                       FontSize="28"
                       FontWeight="DemiBold"
                       HorizontalAlignment="Center"/>
            <TextBlock Text="Логин:"
                       FontSize="18"
                       Margin="0 50 0 0"/>
            <TextBox Name="LoginTextBox"
                     FontSize="18"
                     Height="30"
                     Width="300"/>
            <TextBlock Text="Пароль:"
                       FontSize="18"
                       Margin="0 20 0 0"/>
            <PasswordBox Name="PasswordBox"
                         FontSize="18"
                         Height="30"
                         Width="300"/>
            <Button Content="Войти"
                    FontSize="18"
                    Background="White"
                    Height="30"
                    Width="300"
                    Margin="0 50 0 0"
                    Click="LoginButtonClick"
                    IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using VendingSystemWPF.Services;

namespace VendingSystemWPF.Windows
{
    /// <summary>
    /// Логика взаимодействия для AuthWindow.xaml
    /// </summary>
    public partial class AuthWindow : Window
    {
        private ApiService _apiService; // Для API
        public AuthWindow()
        {
            InitializeComponent();

            _apiService = new ApiService(); // Для API
        }

        private async void LoginButtonClick(object sender, RoutedEventArgs e)
        {
            try
            {
                string login = LoginTextBox.Text.Trim();
                string password = PasswordBox.Password.Trim();

                if (string.IsNullOrEmpty(login) || string.IsNullOrEmpty(password))
                {
                    MessageBox.Show("Не введен логин или пароль!",
                        "ООО Торговые Автоматы",
                        MessageBoxButton.OK,
                        MessageBoxImage.Error);
                    return;
                }

                // Вызываем API
                var result = await _apiService.Login(login, password);

                if (result != null && result.id != null)
                {

                    string userFio = $"{result.surname} {result.name.ToString()[0]}. {result.patronymic.ToString()[0]}.";

                    string userRole = "Неизвестно";

                    int roleId = Convert.ToInt32(result.role);

                    switch (roleId)
                    {
                        case 1:
                            userRole = "Администратор";
                            break;
                        case 2:
                            userRole = "Инженер";
                            break;
                        case 3:
                            userRole = "Бухгалтер";
                            break;
                    }

                    GeneralWindow generalWindow = new GeneralWindow(userFio, userRole);
                    generalWindow.Show();
                    this.Close();
                }
                else
                {
                    MessageBox.Show("Неверный логин или пароль!",
                        "ООО Торговые Автоматы",
                        MessageBoxButton.OK,
                        MessageBoxImage.Error);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Произошла ошибка: {ex.Message}",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.OK,
                    MessageBoxImage.Error);
            }
        }
    }
}
<Window x:Class="VendingSystemWPF.Windows.GeneralWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VendingSystemWPF.Windows"
        mc:Ignorable="d"
        Title="ООО Торговые Автоматы"
        Height="700"
        Width="1000"
        MinHeight="700"
        MinWidth="1000"
        WindowStartupLocation="CenterScreen"
        Icon="/Images/icon.png">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Image Source="../Images/icon.png"
                   Width="40"
                   Height="40"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Left"/>
            <Button VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    Height="40"
                    Width="150"
                    Background="White"
                    HorizontalContentAlignment="Left"
                    Click="ProfileButtonClick"
                    Name="ProfileButton">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="30"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Image Source="/Images/icon.png"
                           Width="30"
                           Height="30"/>
                    <StackPanel Grid.Column="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Vertical">
                        <TextBlock FontSize="12"
                                   Name="FioTextBlock"/>
                        <TextBlock FontSize="10"
                                   Foreground="Gray"
                                   Name="RoleTextBlock"/>
                    </StackPanel>
                </Grid>
            </Button>
            <Popup Name="ProfilePopup"
                   Placement="Bottom"
                   PlacementTarget="{Binding ElementName=ProfileButton}">
                <StackPanel Background="White"
                            Width="150"
                            Height="90"
                            Orientation="Vertical">
                    <Button Content="Мой профиль"
                            Width="150"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"/>
                    <Button Content="Мои сессии"
                            Width="150"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"/>
                    <Button Content="Выход"
                            Width="150"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Click="ExitButtonClick"/>
                </StackPanel>
            </Popup>
        </Grid>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"
                                  Name="SidebarColumnDefinition"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0"
                  Background="AliceBlue">
                <TextBlock Text="Навигация"
                           VerticalAlignment="Top"
                           HorizontalAlignment="Left"
                           FontSize="14"
                           Margin="10 10 0 0"/>
                <Button Content="X"
                        Height="30"
                        Width="30"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top"
                        Click="SidebarButtonClick"
                        Background="LightBlue"
                        BorderThickness="0"/>
                <StackPanel Orientation="Vertical"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Width="200"
                            Margin="0 50 0 0"
                            Name="SidebarStackPanel">
                    <Button Content="Главная"
                            Style="{StaticResource SidebarButton}"
                            HorizontalContentAlignment="Left"
                            Click="MainButtonClick"/>
                    <Button Content="Монитор ТА"
                            Style="{StaticResource SidebarButton}"
                            HorizontalContentAlignment="Left"/>
                    <Expander Header="Детальные отчеты"
                              Style="{StaticResource SidebarExpander}">
                    </Expander>
                    <Expander Header="Учет ТМЦ"
                              Style="{StaticResource SidebarExpander}">
                    </Expander>
                    <Expander Header="Администрирование" 
                              Style="{StaticResource SidebarExpander}">
                        <StackPanel Background="LightBlue">
                            <Button Content="Торговые автоматы"
                                    Style="{StaticResource SidebarButton}"
                                    Click="VendingMachinesButtonClick"/>
                            <Button Content="Компании"
                                    Style="{StaticResource SidebarButton}"/>
                            <Button Content="Пользователи"
                                    Style="{StaticResource SidebarButton}"/>
                            <Button Content="Модемы"
                                    Style="{StaticResource SidebarButton}"/>
                            <Button Content="Дополнительные"
                                    Style="{StaticResource SidebarButton}"/>
                        </StackPanel>
                    </Expander>
                </StackPanel>
            </Grid>
            <Frame Grid.Column="1"
                   Name="MainFrame"
                   Source="../Pages/MainPage.xaml"
                   NavigationUIVisibility="Hidden"/>
        </Grid>
    </Grid>
</Window>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using VendingSystemWPF.Pages;

namespace VendingSystemWPF.Windows
{
    /// <summary>
    /// Логика взаимодействия для GeneralWindow.xaml
    /// </summary>
    public partial class GeneralWindow : Window
    {
        public GeneralWindow(string userFio, string userRole)
        {
            InitializeComponent();

            FioTextBlock.Text = userFio;
            RoleTextBlock.Text = userRole;
        }

        private void ProfileButtonClick(object sender, RoutedEventArgs e)
        {
            if (ProfilePopup.IsOpen == false)
            {
                ProfilePopup.IsOpen = true;
            }
            else
            {
                ProfilePopup.IsOpen = false;
            }
        }

        private void SidebarButtonClick(object sender, RoutedEventArgs e)
        {
            if (SidebarColumnDefinition.Width.Value == 200)
            {
                SidebarColumnDefinition.Width = new GridLength(30);
                SidebarStackPanel.Visibility = Visibility.Collapsed;
            }
            else
            {
                SidebarColumnDefinition.Width = new GridLength(200);
                SidebarStackPanel.Visibility = Visibility.Visible;
            }
        }

        private void ExitButtonClick(object sender, RoutedEventArgs e)
        {
            if (MessageBox.Show("Вы уверены, что хотите выйти?",
                    "ООО Торговые Автоматы",
                    MessageBoxButton.YesNo,
                    MessageBoxImage.Warning) == MessageBoxResult.Yes)
            {
                AuthWindow authWindow = new AuthWindow();
                authWindow.Show();
                this.Close();
            }
        }

        private void VendingMachinesButtonClick(object sender, RoutedEventArgs e)
        {
            MainFrame.Navigate(new VendingMachinesPage());
        }

        private void MainButtonClick(object sender, RoutedEventArgs e)
        {
            MainFrame.Navigate(new MainPage());
        }
    }
}
<Application x:Class="VendingSystemWPF.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:VendingSystemWPF"
             StartupUri="Windows/AuthWindow.xaml">
    <Application.Resources>
        <Style x:Key="SidebarButton" TargetType="Button">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Width" Value="200"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <Style x:Key="SidebarExpander" TargetType="Expander">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FlowDirection" Value="LeftToRight"/>
        </Style>
        
        <!--Элементы на окне AddVendingMachinesWindow-->
        <Style x:Key="AddTextBlock" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0 0 0 20"/>
        </Style>
        <Style x:Key="AddTextBox" TargetType="TextBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="200"/>
            <Setter Property="Margin" Value="0 20 0 0"/>
        </Style>
        <Style x:Key="AddDatePicker" TargetType="DatePicker">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="200"/>
            <Setter Property="Margin" Value="0 20 0 0"/>
        </Style>
        <Style x:Key="AddComboBox" TargetType="ComboBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="200"/>
            <Setter Property="Margin" Value="0 20 0 0"/>
        </Style>
    </Application.Resources>
</Application>
