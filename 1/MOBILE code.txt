using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VendingSystemMobile.Models
{
    // –≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Ç–æ—á–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, —á—Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –æ—Ç API –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
    public class LoginResponseDto
    {
        public int Id { get; set; }
        public string Role { get; set; }
    }
}
using SQLite;
using System;
using System.Collections.Generic;

namespace VendingSystemMobile.Models;

[Table("ServiceTasks")] // <--- –ì–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –≤ –ë–î
public class LocalServiceTask
{
    [PrimaryKey] // <--- –ì–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ Id - —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
    public int Id { get; set; }
    public string Description { get; set; }
    public string Address { get; set; }

    // --- –í–û–¢ –ì–õ–ê–í–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –î–õ–Ø –ë–ê–õ–õ–û–í ---

    // 1. –î–ª—è –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
    public string Status { get; set; } = "–ù–æ–≤–∞—è";

    // 2. –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    public DateTime Date { get; set; }

    // 3. –î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º (–æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º)
    public bool IsSynced { get; set; } = true;
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VendingSystemMobile.Models
{
    // Data Transfer Object - –û–±—ä–µ–∫—Ç –¥–ª—è –ü–µ—Ä–µ–¥–∞—á–∏ –î–∞–Ω–Ω—ã—Ö
    // –ù—É–∂–µ–Ω, —á—Ç–æ–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å API
    public class ServiceTaskDto
    {
        public int Id { get; set; }
        public string Description { get; set; }
        public string Address { get; set; }
        // –î–æ–±–∞–≤—å —Å—é–¥–∞ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è, –µ—Å–ª–∏ —Ç–≤–æ–π API –∏—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    }
}
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VendingSystemMobile.Pages.DetailsPage"
             Title="–î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏">
    
    <ScrollView>
        <VerticalStackLayout Spacing="10" Padding="20">

            <!-- –ë–ª–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
            <Frame Padding="15" BorderColor="LightGray" CornerRadius="5">
                <VerticalStackLayout Spacing="10">
                    <Label Text="–ê–¥—Ä–µ—Å:" FontSize="14" TextColor="Gray"/>
                    <!-- –ü–æ–ª–µ –¥–ª—è –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –±—É–¥–µ–º –∑–∞–ø–æ–ª–Ω—è—Ç—å –∏–∑ –∫–æ–¥–∞ -->
                    <Label x:Name="LblAddress" FontSize="20" FontAttributes="Bold"/>

                    <Label Text="–û–ø–∏—Å–∞–Ω–∏–µ:" FontSize="14" TextColor="Gray" Margin="0,10,0,0"/>
                    <!-- –ü–æ–ª–µ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è -->
                    <Label x:Name="LblDesc" FontSize="16"/>

                    <Label Text="–°—Ç–∞—Ç—É—Å:" FontSize="14" TextColor="Gray" Margin="0,10,0,0"/>
                    <!-- –ü–æ–ª–µ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ -->
                    <Label x:Name="LblStatus" FontSize="18" TextColor="Blue"/>
                </VerticalStackLayout>
            </Frame>

            <!-- –ë–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,20,0,0">
                <Button Grid.Column="0" Text="‚úÖ –ü—Ä–∏–Ω—è—Ç—å" Clicked="Accept_Clicked" BackgroundColor="Green" TextColor="White"/>
                <Button Grid.Column="1" Text="‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å" Clicked="Reject_Clicked" BackgroundColor="Red" TextColor="White"/>
            </Grid>

            <Button Text="üì∏ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ" Clicked="Photo_Clicked" Margin="0,10,0,0"/>
            <Image x:Name="PhotoPreview" HeightRequest="200" Margin="0,10,0,0" IsVisible="False"/>

            <Button Text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª" Clicked="Save_Clicked" BackgroundColor="DodgerBlue" TextColor="White" Margin="0,20,0,0"/>

        </VerticalStackLayout>
    </ScrollView>
    
</ContentPage>
using VendingSystemMobile.Models;

namespace VendingSystemMobile.Pages;

public partial class DetailsPage : ContentPage
{
    // –ó–¥–µ—Å—å –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á—É, —Å –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    private LocalServiceTask _currentTask;

    public DetailsPage(LocalServiceTask task)
    {
        InitializeComponent();

        // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É –≤ –ø–æ–ª–µ _currentTask
        _currentTask = task;

        // 2. "–í–ø–∏—Å—ã–≤–∞–µ–º" –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–¥–∞—á–∏ –≤ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        LblAddress.Text = _currentTask.Address;
        LblDesc.Text = _currentTask.Description;
        LblStatus.Text = _currentTask.Status;
    }

    private async void Accept_Clicked(object sender, EventArgs e)
    {
        // –ú–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î
        _currentTask.Status = "–í —Ä–∞–±–æ—Ç–µ";
        await App.Database.SaveTaskAsync(_currentTask);

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        LblStatus.Text = _currentTask.Status;

        await DisplayAlert("–£—Å–ø–µ—Ö", "–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞ –≤ —Ä–∞–±–æ—Ç—É!", "OK");
    }

    private async void Reject_Clicked(object sender, EventArgs e)
    {
        // –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø—Ä–∏—á–∏–Ω—É
        string reason = await DisplayPromptAsync("–û—Ç–∫–∞–∑", "–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞:");
        if (!string.IsNullOrEmpty(reason))
        {
            _currentTask.Status = $"–û—Ç–∫–ª–æ–Ω–µ–Ω–∞ ({reason})";
            await App.Database.SaveTaskAsync(_currentTask);
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            await Navigation.PopAsync();
        }
    }

    private async void Photo_Clicked(object sender, EventArgs e)
    {
        if (MediaPicker.Default.IsCaptureSupported)
        {
            FileResult photo = await MediaPicker.Default.CapturePhotoAsync();
            if (photo != null)
            {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ç–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
                PhotoPreview.Source = ImageSource.FromFile(photo.FullPath);
                PhotoPreview.IsVisible = true;
            }
        }
    }

    private async void Save_Clicked(object sender, EventArgs e)
    {
        _currentTask.Status = "–í—ã–ø–æ–ª–Ω–µ–Ω–∞";
        await App.Database.SaveTaskAsync(_currentTask);
        await DisplayAlert("–ì–æ—Ç–æ–≤–æ", "–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω", "–û–ö");
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        await Navigation.PopAsync();
    }
}
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VendingSystemMobile.Pages.LoginPage"
             Title="LoginPage">
    <VerticalStackLayout Spacing="20" Padding="30" VerticalOptions="Center">

        <!-- –õ–æ–≥–æ—Ç–∏–ø (–ö—Ä–∏—Ç–µ—Ä–∏–π) -->
        <Image Source="dotnet_bot.png" HeightRequest="100" HorizontalOptions="Center" />

        <Label Text="–í–•–û–î –í –°–ò–°–¢–ï–ú–£" FontSize="24" FontAttributes="Bold" HorizontalOptions="Center"/>

        <Entry x:Name="LoginEntry" Placeholder="–õ–æ–≥–∏–Ω" />
        <Entry x:Name="PasswordEntry" Placeholder="–ü–∞—Ä–æ–ª—å" IsPassword="True" />

        <Button Text="–í–æ–π—Ç–∏" Clicked="OnLoginClicked" BackgroundColor="Blue" TextColor="White"/>
    </VerticalStackLayout>
</ContentPage>
using VendingSystemMobile.Models;
using VendingSystemMobile.Services;

namespace VendingSystemMobile.Pages;

public partial class LoginPage : ContentPage
{
    ApiService _api = new ApiService();

    public LoginPage()
    {
        InitializeComponent();
        CheckAutoLogin();
    }

    private async void CheckAutoLogin()
    {
        // –ö—Ä–∏—Ç–µ—Ä–∏–π: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
        if (Preferences.ContainsKey("UserId"))
        {
            Application.Current.MainPage = new AppShell();
        }
    }

    private async void OnLoginClicked(object sender, EventArgs e)
    {
        var login = LoginEntry.Text;
        var pass = PasswordEntry.Text;

        var user = await _api.Login(login, pass);

        if (user != null)
        {
            // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            Preferences.Set("UserId", user.Id);
            Preferences.Set("UserRole", user.Role);

            // --- –ù–ê–ß–ê–õ–û –ù–û–í–û–ì–û –ö–û–î–ê ---

            // 2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º "—Å—ã—Ä—ã–µ" –∑–∞–¥–∞—á–∏ —É API
            List<ServiceTaskDto> apiTasks = await _api.GetTasksAsync();

            if (apiTasks.Any()) // Any() - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –≤ —Å–ø–∏—Å–∫–µ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ
            {
                // 3. –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º "—Å—ã—Ä—ã–µ" –∑–∞–¥–∞—á–∏ –≤ "–ª–æ–∫–∞–ª—å–Ω—ã–µ" –¥–ª—è –Ω–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
                var localTasks = apiTasks.Select(apiTask => new LocalServiceTask
                {
                    Id = apiTask.Id,
                    Description = apiTask.Description,
                    Address = apiTask.Address,
                    Status = "–ù–æ–≤–∞—è", // –ó–∞–¥–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    Date = DateTime.Now // –ó–∞–¥–∞–µ–º –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                }).ToList();

                // 4. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                await App.Database.SaveTasksAsync(localTasks);
            }

            // --- –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ö–û–î–ê ---

            // 5. –ò —Ç–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
            Application.Current.MainPage = new AppShell();
        }
        else
        {
            await DisplayAlert("–û—à–∏–±–∫–∞", "–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å", "OK");
        }
    }
}
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:VendingSystemMobile.Models"
             x:Class="VendingSystemMobile.Pages.MainPage"
             Title="–ì–ª–∞–≤–Ω–∞—è">


    <Grid RowDefinitions="Auto, *">
        <Label Grid.Row="0" Text="–ú–æ–∏ –∑–∞–¥–∞—á–∏" FontSize="22" FontAttributes="Bold" Padding="15"/>

        <CollectionView Grid.Row="1" x:Name="TasksList"
                        SelectionMode="Single" 
                        SelectionChanged="OnTaskSelected">
            <CollectionView.ItemTemplate>

                <!-- 
                    x:DataType - —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞. 
                    –û–Ω–∞ –ø–æ–º–æ–≥–∞–µ—Ç –µ–º—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—à–∏–±–∫–∏ –µ—â–µ –¥–æ –∑–∞–ø—É—Å–∫–∞ 
                    –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å–ø–∏—Å–∫–∞. –≠—Ç–æ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞!
                -->
                <DataTemplate x:DataType="models:LocalServiceTask">
                    <Frame Margin="10,5" Padding="15" BorderColor="LightGray" CornerRadius="5">
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding Address}" FontSize="18" FontAttributes="Bold"/>
                            <Label Text="{Binding Description}" FontSize="14" TextColor="Gray"/>
                            <Label Text="{Binding Status}" FontSize="14" HorizontalOptions="End"/>
                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>

</ContentPage>
using Microsoft.Extensions.Logging.Abstractions;
using VendingSystemMobile.Models;
using VendingSystemMobile.Services;

namespace VendingSystemMobile.Pages;

public partial class MainPage : ContentPage
{
    public MainPage()
    {
        InitializeComponent();
    }

    // –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ü–û–Ø–í–õ–Ø–ï–¢–°–Ø –Ω–∞ —ç–∫—Ä–∞–Ω–µ
    protected override async void OnAppearing()
    {
        base.OnAppearing();

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–¥–∞—á–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö –≤ —Å–ø–∏—Å–∫–µ
        TasksList.ItemsSource = await App.Database.GetTasksAsync();
    }

    // –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞–∂–∏–º–∞–µ—à—å –Ω–∞ –∑–∞–¥–∞—á—É –≤ —Å–ø–∏—Å–∫–µ
    private async void OnTaskSelected(object sender, SelectionChangedEventArgs e)
    {
        if (e.CurrentSelection.FirstOrDefault() is LocalServiceTask task)
        {
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–π –≤—ã–±—Ä–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É
            await Navigation.PushAsync(new DetailsPage(task));

            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –Ω–∞–∂–∞—Ç—å –µ—â–µ —Ä–∞–∑
            ((CollectionView)sender).SelectedItem = null;
        }
    }
}
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VendingSystemMobile.Pages.TaskDetailsPage"
             Title="–î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏">

    <ScrollView Padding="20">
        <VerticalStackLayout Spacing="15">
            <Label x:Name="AddressLabel" FontSize="20" FontAttributes="Bold"/>
            <Label x:Name="DescLabel" FontSize="16"/>

            <!-- –°—Ç–∞—Ç—É—Å -->
            <Label Text="–°—Ç–∞—Ç—É—Å:" TextColor="Gray"/>
            <Label x:Name="StatusLabel" FontSize="18" TextColor="Blue"/>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <HorizontalStackLayout Spacing="20" HorizontalOptions="Center" Margin="0,20">
                <Button Text="–ü—Ä–∏–Ω—è—Ç—å" Clicked="OnAcceptClicked" BackgroundColor="Green"/>
                <Button Text="–û—Ç–∫–ª–æ–Ω–∏—Ç—å" Clicked="OnRejectClicked" BackgroundColor="Red"/>
            </HorizontalStackLayout>

            <!-- –ß–µ–∫-–ª–∏—Å—Ç (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è) -->
            <VerticalStackLayout x:Name="ChecklistLayout" IsVisible="False" Spacing="10">
                <Label Text="–ü–†–û–¢–û–ö–û–õ –û–°–ú–û–¢–†–ê" FontAttributes="Bold" Margin="0,10"/>
                <CheckBox />
                <Label Text="–í–Ω–µ—à–Ω–∏–π –æ—Å–º–æ—Ç—Ä"/>
                <CheckBox />
                <Label Text="–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ø—é—Ä–æ–ø—Ä–∏–µ–º–Ω–∏–∫–∞"/>
                <CheckBox />
                <Label Text="–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–≤–∞—Ä–æ–≤"/>

                <Editor Placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–Ω–∂–µ–Ω–µ—Ä–∞..." HeightRequest="100"/>

                <Button Text="–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É" Clicked="OnCompleteClicked" BackgroundColor="Blue"/>
            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>


</ContentPage>
using VendingSystemMobile.Models;

namespace VendingSystemMobile.Pages;

public partial class TaskDetailsPage : ContentPage
{
    LocalServiceTask _task;

    public TaskDetailsPage(LocalServiceTask task)
    {
        InitializeComponent();
        _task = task;
        BindingContext = _task;

        AddressLabel.Text = _task.Address;
        DescLabel.Text = _task.Description;
        StatusLabel.Text = _task.Status;

        if (_task.Status == "–í —Ä–∞–±–æ—Ç–µ")
        {
            ChecklistLayout.IsVisible = true;
        }
    }

    private void OnAcceptClicked(object sender, EventArgs e)
    {
        _task.Status = "–í —Ä–∞–±–æ—Ç–µ";
        StatusLabel.Text = "–í —Ä–∞–±–æ—Ç–µ";
        ChecklistLayout.IsVisible = true;
        // –ó–¥–µ—Å—å –ø–æ —Ö–æ—Ä–æ—à–µ–º—É –Ω–∞–¥–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤ –ë–î
    }

    private async void OnRejectClicked(object sender, EventArgs e)
    {
        string result = await DisplayPromptAsync("–û—Ç–º–µ–Ω–∞", "–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞?");
        if (!string.IsNullOrEmpty(result))
        {
            _task.Status = "–û—Ç–º–µ–Ω–µ–Ω–∞";
            StatusLabel.Text = "–û—Ç–º–µ–Ω–µ–Ω–∞";
            await Navigation.PopAsync();
        }
    }

    private async void OnCompleteClicked(object sender, EventArgs e)
    {
        _task.Status = "–í—ã–ø–æ–ª–Ω–µ–Ω–∞";
        await DisplayAlert("–£—Å–ø–µ—Ö", "–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ", "OK");
        await Navigation.PopAsync();
    }
}
using Newtonsoft.Json;
using System;
using System.Buffers.Text;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http.Json; // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–¥–∫–ª—é—á–∏ —ç—Ç–æ!
using System.Text;
using System.Threading.Tasks;
using VendingSystemMobile.Models;

namespace VendingSystemMobile.Services
{
    public class ApiService
    {
        // –í–ù–ò–ú–ê–ù–ò–ï: –î–ª—è Android —ç–º—É–ª—è—Ç–æ—Ä–∞ localhost —ç—Ç–æ 10.0.2.2
        // –ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—à—å Windows –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ - localhost
        private readonly string _baseUrl = DeviceInfo.Platform == DevicePlatform.Android
            ? "http://0.0.0.0:5022/api" // <-- –ò—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–π –ø–æ—Ä—Ç, –µ—Å–ª–∏ –æ–Ω –¥—Ä—É–≥–æ–π
            : "http://localhost:5022/api";

        private readonly HttpClient _client;

        public ApiService()
        {
            _client = new HttpClient();
        }

        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∞—Å—Å, –∞ –Ω–µ dynamic
        public async Task<LoginResponseDto> Login(string login, string password)
        {
            var json = JsonConvert.SerializeObject(new { Login = login, Password = password });
            var content = new StringContent(json, Encoding.UTF8, "application/json");

            try
            {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º _client –∏ _baseUrl —Å –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º
                var response = await _client.PostAsync($"{_baseUrl}/Auth/login", content);

                if (response.IsSuccessStatusCode)
                {
                    var result = await response.Content.ReadAsStringAsync();
                    return JsonConvert.DeserializeObject<LoginResponseDto>(result);
                }
            }
            catch (Exception ex)
            {
                await App.Current.MainPage.DisplayAlert("–û—à–∏–±–∫–∞ API", ex.Message, "OK");
            }

            return null;
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á —Å —Å–µ—Ä–≤–µ—Ä–∞
        public async Task<List<ServiceTaskDto>> GetTasksAsync()
        {
            try
            {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º _client –∏ _baseUrl, –∫–æ—Ç–æ—Ä—ã–µ —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å
                var response = await _client.GetAsync($"{_baseUrl}/Services");

                if (response.IsSuccessStatusCode)
                {
                    var json = await response.Content.ReadAsStringAsync();
                    // –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –≤ –Ω–∞—à –±–µ–∑–æ–ø–∞—Å–Ω—ã–π "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä"
                    return JsonConvert.DeserializeObject<List<ServiceTaskDto>>(json);
                }
            }
            catch (Exception ex)
            {
                await App.Current.MainPage.DisplayAlert("–û—à–∏–±–∫–∞ API", $"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á–∏: {ex.Message}", "OK");
            }

            return new List<ServiceTaskDto>(); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
        }
    }
}
using SQLite;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using VendingSystemMobile.Models;

namespace VendingSystemMobile.Services
{
    public class DatabaseService
    {
        private readonly SQLiteAsyncConnection _database;

        public DatabaseService()
        {
            var dbPath = Path.Combine(FileSystem.AppDataDirectory, "VendingLocal.db3");
            _database = new SQLiteAsyncConnection(dbPath);
            _database.CreateTableAsync<LocalServiceTask>().Wait();
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –í–°–ï–• –∑–∞–¥–∞—á –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î (–¥–ª—è MainPage)
        public Task<List<LocalServiceTask>> GetTasksAsync()
        {
            return _database.Table<LocalServiceTask>().ToListAsync();
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –û–î–ù–û–ô –∑–∞–¥–∞—á–∏ (–ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –Ω–∞ DetailsPage)
        public Task<int> SaveTaskAsync(LocalServiceTask task)
        {
            if (task.Id != 0)
            {
                return _database.UpdateAsync(task);
            }
            else
            {
                return _database.InsertAsync(task);
            }
        }

        // --- –í–û–¢ –û–ù, –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ú–ï–¢–û–î ---
        // –ú–µ—Ç–æ–¥ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –°–ü–ò–°–ö–ê –∑–∞–¥–∞—á (–¥–ª—è LoginPage)
        public async Task SaveTasksAsync(List<LocalServiceTask> tasks)
        {
            // InsertOrReplaceAsync - –æ—á–µ–Ω—å —É–¥–æ–±–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.
            // –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Å —Ç–∞–∫–∏–º Id —É–∂–µ –µ—Å—Ç—å, –æ–Ω –µ–µ –æ–±–Ω–æ–≤–∏—Ç.
            // –ï—Å–ª–∏ –Ω–µ—Ç - –¥–æ–±–∞–≤–∏—Ç –Ω–æ–≤—É—é.
            foreach (var task in tasks)
            {
                await _database.InsertOrReplaceAsync(task);
            }
        }
    }
}
<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="VendingSystemMobile.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:VendingSystemMobile"
    xmlns:pages="clr-namespace:VendingSystemMobile.Pages" 
    Title="VendingSystemMobile">
    <!-- 
        xmlns:pages="clr-namespace:VendingSystemMobile.Pages" –≠–¢–û –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ü–ê–ü–ö–ò!
    
        AppShell - —ç—Ç–æ "–≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" –ü–û–°–õ–ï —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞.
        –û–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π (–Ω–∏–∂–Ω–∏–º–∏ –≤–∫–ª–∞–¥–∫–∞–º–∏).
        –ú—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω–µ–≥–æ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã LoginPage.
    -->

    <TabBar>
        <!-- –í–æ—Ç –∑–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º "–ø—Ä–æ–∑–≤–∏—â–µ" pages:, –∏ —Ç–µ–ø–µ—Ä—å XAML –∑–Ω–∞–µ—Ç, –≥–¥–µ –∏—Å–∫–∞—Ç—å MainPage -->
        <ShellContent 
            Title="–ì–ª–∞–≤–Ω–∞—è" 
            Icon="home.png" 
            ContentTemplate="{DataTemplate pages:MainPage}" />

        <!-- –≠—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º—ã –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª–∏, –ø–æ—ç—Ç–æ–º—É –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Ö "–≤—ã–∫–ª—é—á–∞–µ–º" (–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º) -->
        <!--
        <ShellContent Title="–ú–æ–∏ –æ—Ç—á–µ—Ç—ã" Icon="report.png" ContentTemplate="{DataTemplate pages:ReportsPage}" />
        <ShellContent Title="–ü—Ä–æ—Ñ–∏–ª—å" Icon="user.png" ContentTemplate="{DataTemplate pages:ProfilePage}" />
        -->
    </TabBar>
    
    
</Shell>
using Microsoft.Extensions.Logging;

namespace VendingSystemMobile
{
    public static class MauiProgram
    {
        public static MauiApp CreateMauiApp()
        {
            var builder = MauiApp.CreateBuilder();
            builder
                .UseMauiApp<App>()
                .ConfigureFonts(fonts =>
                {
                    fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
                    fonts.AddFont("OpenSans-Semibold.ttf", "OpenSansSemibold");
                });

#if DEBUG
    		builder.Logging.AddDebug();
#endif

            return builder.Build();
        }
    }
}
